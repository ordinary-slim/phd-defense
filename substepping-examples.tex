\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{2D square track}

    \begin{adjustwidth}{-10mm}{-10mm}
    \begin{figure}
    \centering
    \begin{tabular}{cccc}
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \begin{tikzpicture}
          \node[anchor=south west, inner sep=0] (image) at (0, 0) {
            \includegraphics[height=0.35\pageheight, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/sols/linear_ref_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
          };
        \end{tikzpicture}
        \caption{Solution -- No substepping.}
        \label{fig:sol_ref_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \begin{tikzpicture}
          \node[anchor=south west, inner sep=0] (image) at (0, 0) {
            \includegraphics[height=0.35\pageheight, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/sols/robin_linear_ss_rr_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
          };
        \node[text opacity=1] at ($(image.west)!0.35!(image.east) + (0.0, 0.0)$) {\labelbox{$\Omega_f$}};
        \end{tikzpicture}
        \caption{Solution -- Robin.}
        \label{fig:sol_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \begin{tikzpicture}
          \node[anchor=south west, inner sep=0] (image) at (0, 0) {
            \includegraphics[height=0.35\pageheight, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/sols/chimera_ss_RR_linear_css_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
          };
          \node[text opacity=1] at ($(image.west)!0.35!(image.east) + (0.0, 0.0)$) {\labelbox{$\Omega_f$}};
          \node[text opacity=1, anchor=south, inner sep=1pt] at ($(image.south west)!0.36!(image.south east) + (0.0, 0.0)$) {\labelbox{$\Omega_m$}};
        \end{tikzpicture}
        \caption{Solution -- Robin with AS.}
        \label{fig:sol_chimera_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.1\textwidth}
        \raisebox{0.1\height}{
          \vcolorbar{rainbow_blended_white}{0.2cm}{25}{2000}{$u_h$}{}
        }
      \end{subfigure}
      \\[5mm]
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \includegraphics[height=0.35\pageheight, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/errs/linear_ref_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
        \caption{Squared error -- No substepping.}
        \label{fig:err_ref_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \includegraphics[height=0.35\pageheight, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/errs/robin_linear_ss_rr_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
        \caption{Squared error -- Robin.}
        \label{fig:err_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \includegraphics[height=0.35\pageheight, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/errs/chimera_ss_RR_linear_css_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
        \caption{Squared error -- Robin with AS.}
        \label{fig:err_chimera_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.1\textwidth}
        \raisebox{0.1\height}{
        \vcolorbar{fast}{0.2cm}{0}{10000}{$(u_h - u_{ex})^2$}{}
        }
      \end{subfigure}
    \end{tabular}
    % \caption{Solutions (top row) and pointwise squared errors (bottom row) in the linear case for the Robin substepper
    %   with and without an AS, with $\Delta t_s = 8 T_{hs}$ and $\Delta t_f = 0.5 T_{hs}$.
    %   The unsubstepped solution with $\Delta t = 0.5 T_{hs}$ is shown for reference.
    %   The substeppers introduce some error throughout the domain.
    %   The advected subdomain reduces the error in the HAZ but increases the error near the track turns.
    % }
    \label{fig:err_linear_vsadvected}
  \end{figure}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{2D square track}
  \input{./plots/2dsquare_midline/plot.tex}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{2D square track}
  \begin{adjustwidth}{-7mm}{-5mm}
    \input{./plots/truncated_iters/plot.tex}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{Experimental validation}
  Validation against experimental melt pool shape data of \cite{lane2020} (AMB2018-02),
  as done in \cite{kopp2022}.\\
  \begin{adjustwidth}{-5mm}{-5mm}
    \input{./plots/meltpool_contours/fig.tex}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{3D LPBF cube}
  \begin{figure}
    \centering
    \begin{subfigure}[b]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{stacked_cubes/mesh.png}}
      \caption{Mesh and material composition at start of print.}
      \label{fig:3d_lpbf_mesh}
    \end{subfigure}%
    \hfill
    \begin{subfigure}[b]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{stacked_cubes/scan_path.png}}
      \caption{Printing path.}
      \label{fig:3d_lpbf_path}
    \end{subfigure}%
    \hfill
    \begin{subfigure}[b]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{stacked_cubes/bulk_mesh.png}}
      \caption{Bulk material at final time.}
      \label{fig:3d_lpbf_bulk_mesh}
    \end{subfigure}
    \caption{\centering \SI{1}{\milli\meter} cube. Powder elements
      corresponding to each layer are activated during recoating time-steps.
    \qquad \legendpowderbulk{}}
  \end{figure}
\end{frame}

\input{plots/3d_lpbf_cube_speedups_table/main.tex}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{3D LPBF cube}

  \vspace{-2mm}
  \input{./plots/stacked_cubes_probe/plot.tex}
\end{frame}
