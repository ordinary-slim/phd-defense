\begin{frame}
  \frametitle{Substepping}
  \cite{slimani2025}:
  \begin{itemize}
    \item Examines SOA of substepping methods for LPBF;
      identifies common structures and shortcomings.
    \item New Robin-Robin substepper for LPBF is compared against
      Dirichlet substepper of \cite{hodge2021}.
    \item Realistic speedup estimates provided.
    \item Alternate predictor schemes are proposed and tested.
    \item Robin-Robin version of AS method is proposed.
    \item AS is nested within the fast partition of said substeppers.
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Substepping + advected subdomain}
  \begin{figure}
    \centering
    \seudoembeddedvod{width=1.0\textwidth}{videos/basic-demo-css.mp4}{thumbnail-basic-css.png}
    \caption{Basic demo of combined substepping + advected subdomain method.}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{Example time-step}
  \begin{figure}
    \begin{subfigure}[t]{0.46\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{ss_robin/prev_sol.png}}
      \caption{$T^{n}$}
      \label{fig:robin_prev}
    \end{subfigure}%
    \hfill%
    \begin{subfigure}[t]{0.46\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{ss_robin/predictor.png}}
      \caption{$\tilde{T}^{n+1}$ after predictor step}
      \label{fig:robin_predictor}
    \end{subfigure}
    \caption{Previous solution and predictor step.}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{Example time-step}
  \begin{figure}
  \begin{subfigure}[t]{0.46\textwidth}
    \centering
    \includegraphics[width=\textwidth]{{ss_robin/micro_step.png}}
    \caption{Intermediate \textbf{Robin} substep.}
    \label{fig:robin_substep}
  \end{subfigure}%
  \hfill%
  \begin{subfigure}[t]{0.46\textwidth}
    \centering
    \begin{tikzpicture}
      \node[anchor=south west, inner sep=0] (A) {\includegraphics[width=\textwidth]{{ss_robin/macro_step.png}}};
    \begin{scope}[x={(A.south east)},y={(A.north west)}]
      % Rectangle highlight (coordinates between 0 and 1)
      %\draw[teal!20, step=0.05] (0,0) grid (1,1);%grid, comment out for draft
      \draw[red, thick, dash pattern=on 1pt off 1pt] (0.286, 0.5475) circle (0.02);
      \draw[red, thick, dash pattern=on 1pt off 1pt] (0.286, 0.6385) circle (0.02);
    \end{scope}
    \end{tikzpicture}
    \caption{\textbf{Robin} corrector step.}
    \label{fig:robin_corrector}
  \end{subfigure}
  \caption{Robin-Robin substepper.}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{Example time-step}
  \begin{figure}
    \begin{subfigure}[t]{0.46\textwidth}
      \centering
      \begin{tikzpicture}
        \node[anchor=south west, inner sep=0] (A) {\includegraphics[width=\textwidth]{{hodge/micro_step.png}}};
      \begin{scope}[x={(A.south east)},y={(A.north west)}]
        % Rectangle highlight (coordinates between 0 and 1)
        %\draw[teal!20, step=0.01] (0,0) grid (1,1);%grid, comment out for draft
        \draw[red, thick, dash pattern=on 1pt off 1pt, rounded corners] (0.0625, 0.450) rectangle (0.2, 0.5);
        \draw[red, thick, dash pattern=on 1pt off 1pt, rounded corners] (0.2500, 0.5505) rectangle (0.3100, 0.7100);
      \end{scope}
      \end{tikzpicture}
      \caption{Intermediate \textbf{Dirichlet} substep. The Dirichlet
      condition does not let the solution deviate from the predictor.}
      \label{fig:hodge_substep}
    \end{subfigure}%
    \hfill%
    \begin{subfigure}[t]{0.46\textwidth}
      \centering
      \begin{tikzpicture}
        \node[anchor=south west, inner sep=0] (A) {\includegraphics[width=\textwidth]{{hodge/macro_step.png}}};
      \begin{scope}[x={(A.south east)},y={(A.north west)}]
        % Rectangle highlight (coordinates between 0 and 1)
        %\draw[teal!20, step=0.01] (0,0) grid (1,1);%grid, comment out for draft
        \draw[red, thick, dash pattern=on 1pt off 1pt, rounded corners] (0.065, 0.4550) rectangle (0.1905, 0.4905);
        \draw[red, thick, dash pattern=on 1pt off 1pt, rounded corners] (0.2600, 0.5605) rectangle (0.3000, 0.7000);
      \end{scope}
      \end{tikzpicture}
  \caption{\textbf{Dirichlet} corrector step.}
  \label{fig:hodge_corrector}
\end{subfigure}
    \caption{Dirichlet substepper of \cite{hodge2021}.}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{No heat source predictor}

  \begin{figure}
    \begin{subfigure}[t]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{hodge/to_predictor.png}
      \caption{Predictor step without heat input}
      \label{fig:to_hodge_predictor}
    \end{subfigure}%
    \hfill
    \begin{subfigure}[t]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{hodge/to_micro_step.png}
      \caption{Micro-step.}
      \label{fig:to_hodge_micro}
    \end{subfigure}%
    \hfill
    \begin{subfigure}[t]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{hodge/to_macro_step.png}
      \caption{Corrector step.}
      \label{fig:to_hodge_macro}
    \end{subfigure}
    \caption{Example of Dirichlet substepper step using a predictor step without including the source term.}
    \label{fig:to_hodge}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{2D square track}

    \begin{adjustwidth}{-10mm}{-10mm}
    \begin{figure}
    \centering
    \begin{tabular}{cccc}
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \begin{tikzpicture}
          \node[anchor=south west, inner sep=0] (image) at (0, 0) {
            \includegraphics[width=\textwidth, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/sols/linear_ref_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
          };
        \end{tikzpicture}
        \caption{Solution -- No substepping.}
        \label{fig:sol_ref_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \begin{tikzpicture}
          \node[anchor=south west, inner sep=0] (image) at (0, 0) {
            \includegraphics[width=\textwidth, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/sols/robin_linear_ss_rr_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
          };
        \node[text opacity=1] at ($(image.west)!0.35!(image.east) + (0.0, 0.0)$) {\labelbox{$\Omega_f$}};
        \end{tikzpicture}
        \caption{Solution -- Robin.}
        \label{fig:sol_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \begin{tikzpicture}
          \node[anchor=south west, inner sep=0] (image) at (0, 0) {
            \includegraphics[width=\textwidth, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/sols/chimera_ss_RR_linear_css_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
          };
          \node[text opacity=1] at ($(image.west)!0.35!(image.east) + (0.0, 0.0)$) {\labelbox{$\Omega_f$}};
          \node[text opacity=1, anchor=south, inner sep=1pt] at ($(image.south west)!0.36!(image.south east) + (0.0, 0.0)$) {\labelbox{$\Omega_m$}};
        \end{tikzpicture}
        \caption{Solution -- Robin with AS.}
        \label{fig:sol_chimera_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.1\textwidth}
        \raisebox{0.1\height}{
          \vcolorbar{rainbow_blended_white}{0.2cm}{25}{2000}{$u_h$}{}
        }
      \end{subfigure}
      \\[5mm]
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \includegraphics[width=\textwidth, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/errs/linear_ref_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
        \caption{Squared error -- No substepping.}
        \label{fig:err_ref_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \includegraphics[width=\textwidth, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/errs/robin_linear_ss_rr_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
        \caption{Squared error -- Robin.}
        \label{fig:err_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.28\textwidth}
        \centering
        \includegraphics[width=\textwidth, clip=true, trim={0cm 0cm 12cm 0cm}]{{2d_square_track/errs/chimera_ss_RR_linear_css_pred0_16els_tf0_5_ts8_0_time0_0032.png}}
        \caption{Squared error -- Robin with AS.}
        \label{fig:err_chimera_robin_t4}
      \end{subfigure}
      &
      \begin{subfigure}[t]{0.1\textwidth}
        \raisebox{0.1\height}{
        \vcolorbar{fast}{0.2cm}{0}{10000}{$(u_h - u_{ex})^2$}{}
        }
      \end{subfigure}
    \end{tabular}
    % \caption{Solutions (top row) and pointwise squared errors (bottom row) in the linear case for the Robin substepper
    %   with and without an AS, with $\Delta t_s = 8 T_{hs}$ and $\Delta t_f = 0.5 T_{hs}$.
    %   The unsubstepped solution with $\Delta t = 0.5 T_{hs}$ is shown for reference.
    %   The substeppers introduce some error throughout the domain.
    %   The advected subdomain reduces the error in the HAZ but increases the error near the track turns.
    % }
    \label{fig:err_linear_vsadvected}
  \end{figure}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{2D square track}
  \input{./plots/2dsquare_midline/plot.tex}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{2D square track}
  \begin{adjustwidth}{-7mm}{-5mm}
    \input{./plots/truncated_iters/plot.tex}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{Experimental validation}
  Validation against experimental melt pool shape data of \cite{lane2020} (AMB2018-02),
  as done in \cite{kopp2022}.\\
  \begin{adjustwidth}{-5mm}{-5mm}
    \input{./plots/meltpool_contours/fig.tex}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{3D LPBF cube}
  \begin{figure}
    \centering
    \begin{subfigure}[b]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{stacked_cubes/mesh.png}}
      \caption{Mesh and material composition at start of print.}
      \label{fig:3d_lpbf_mesh}
    \end{subfigure}%
    \hfill
    \begin{subfigure}[b]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{stacked_cubes/scan_path.png}}
      \caption{Printing path.}
      \label{fig:3d_lpbf_path}
    \end{subfigure}%
    \hfill
    \begin{subfigure}[b]{0.33\textwidth}
      \centering
      \includegraphics[width=\textwidth]{{stacked_cubes/bulk_mesh.png}}
      \caption{Bulk material at final time.}
      \label{fig:3d_lpbf_bulk_mesh}
    \end{subfigure}
    \caption{\centering \SI{1}{\milli\meter} cube. Powder elements
      corresponding to each layer are activated during recoating time-steps.
    \qquad \legendpowderbulk{}}
  \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{3D LPBF cube}

  \vspace{-7mm}
  \input{./plots/stacked_cubes_probe/plot.tex}
\end{frame}

\begin{frame}
  \frametitle{Substepping}
  \framesubtitle{3D LPBF cube}
  \begin{itemize}
    \item Speed-up factors range from about $1.3$--$2.0$ for fast DOF ratios around
    $30\%$, up to roughly $4$--$6.5$ when the fast DOF ratio drops below
    $10\%$, depending on substepper and use of AS.
    \item Robin substepping slightly outperforms Dirichlet.
    \item AS approach yields increasing speed-ups with domain size; substantial gains for cubes $\geq 2\,\si{\milli\meter}$.
    \item For short tracks and large macro-steps, fast-domain DOF fraction can exceed profitability threshold and reduce speed-up.
    \item AS distorts thermal tail when advected subdomain overlaps previous tracks.
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Substepping + advected subdomain}
  \framesubtitle{Final conclusions}
  \begin{itemize}
    \item The AS method improved HAZ accuracy and allowed much larger
      time-steps (up to several \(T_{hs}\)), at the cost of losing SPD
      structure and increasing per-step cost by roughly a factor of 2â€“3.
    \item AS works best on long, simple tracks; direction
      changes and overlapping tracks shear thermal tails and can severely
      degrade accuracy, limiting applicability as a general speed-up
      technique.
    \item Substepping, via fast/slow domain partitioning with
      \(\Delta t_f\) and \(\Delta t_s \gg \Delta t_f\), provided a more
      robust and broadly applicable way to exploit time-scale disparity in
      LPBF.
    \end{itemize}
  \end{frame}
